<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta name="description" content=""><meta name="keywords" content=""><meta name="author" content="Charon Cheung"><meta name="copyright" content="Charon Cheung"><title>If you wish for peace, prepare for war | 沉默杀手</title><link rel="shortcut icon" href="/melody-favicon.ico"><link rel="stylesheet" href="/css/index.css?version=1.6.1"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome@latest/css/font-awesome.min.css?version=1.6.1"><link rel="dns-prefetch" href="https://cdn.staticfile.org"><link rel="dns-prefetch" href="https://cdn.bootcss.com"><link rel="dns-prefetch" href="https://creativecommons.org"><script>var GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  copy: {
    success: 'Copy successfully',
    error: 'Copy error',
    noSupport: 'The browser does not support'
  }
} </script><meta name="generator" content="Hexo 5.4.0"></head><body><canvas class="fireworks"></canvas><i class="fa fa-arrow-right" id="toggle-sidebar" aria-hidden="true"></i><div id="sidebar"><div class="author-info"><div class="author-info__avatar text-center"><img src="/img/avatar.png"></div><div class="author-info__name text-center">Charon Cheung</div><div class="author-info__description text-center"></div><hr><div class="author-info-articles"><a class="author-info-articles__archives article-meta" href="/archives"><span class="pull-left">Articles</span><span class="pull-right">476</span></a><a class="author-info-articles__tags article-meta" href="/tags"><span class="pull-left">Tags</span><span class="pull-right">5</span></a><a class="author-info-articles__categories article-meta" href="/categories"><span class="pull-left">Categories</span><span class="pull-right">43</span></a></div></div></div><nav id="nav" style="background-image: url(https://i.loli.net/2021/07/13/RCLw5Bx8aFPN74b.jpg)"><div id="page-header"><span class="pull-left"> <a id="site-name" href="/">沉默杀手</a></span><i class="fa fa-bars toggle-menu pull-right" aria-hidden="true"></i><span class="pull-right menus"><a class="site-page" href="/">Home</a><a class="site-page" href="/archives">Archives</a><a class="site-page" href="/tags">Tags</a><a class="site-page" href="/categories">Categories</a></span></div><div id="site-info"><div id="site-title">沉默杀手</div><div id="site-sub-title">If you wish for peace, prepare for war</div></div></nav><div id="content-outer"><div class="layout" id="content-inner"><div class="recent-post-item article-container"><a class="article-title" href="/2021/12/11/%E8%B7%AF%E5%BE%84%E8%A7%84%E5%88%92/%E5%BC%A0%E6%A5%ABDual-Stage%20Viewpoint%20Planner/DSV%20Planner%E7%9A%84%E4%BD%BF%E7%94%A8/">DSV Planner的使用</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2021-12-11</time><span class="article-meta"><span class="article-meta__separator">|</span><i class="fa fa-inbox article-meta__icon" aria-hidden="true"></i><a class="article-meta__categories" href="/categories/%E8%B7%AF%E5%BE%84%E8%A7%84%E5%88%92/">路径规划</a><i class="fa fa-angle-right" aria-hidden="true"></i><i class="fa fa-inbox article-meta__icon" aria-hidden="true"></i><a class="article-meta__categories" href="/categories/%E8%B7%AF%E5%BE%84%E8%A7%84%E5%88%92/Dual-Stage-Viewpoint-Planner/">Dual-Stage Viewpoint Planner</a></span><div class="content"><h2 id="Detailed-Instructions"><a href="#Detailed-Instructions" class="headerlink" title="Detailed Instructions"></a>Detailed Instructions</h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">sudo apt update</span><br><span class="line">sudo apt install ros-melodic-octomap-ros libgoogle-glog-dev libgflags-dev</span><br><span class="line"><span class="comment"># 取melodic分支</span></span><br><span class="line">git <span class="built_in">clone</span> https://github.com/HongbiaoZ/dsv_planner.git</span><br></pre></td></tr></table></figure>
<p>编译结束后，运行<br><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 车库仿真环境，可以换成其他的</span></span><br><span class="line">roslaunch vehicle_simulator system_garage.launch</span><br><span class="line">roslaunch dsvp_launch explore_garage.launch</span><br></pre></td></tr></table></figure></p>
<p>然后是<code>Matterport3D</code>环境的配置，先跳过：To run DSV Planner in a Matterport3D environment, follow instructions to setup the development environment to use the Matterport3D environment. Then, use the command lines below to launch the system and DSV Planner.<br><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">roslaunch vehicle_simulator system_matterport.launch</span><br><span class="line">roslaunch dsvp_launch explore_matterport.launch</span><br></pre></td></tr></table></figure></p>
</div><hr></div><div class="recent-post-item article-container"><a class="article-title" href="/2021/12/11/%E8%B7%AF%E5%BE%84%E8%A7%84%E5%88%92/%E5%BC%A0%E6%A5%ABDual-Stage%20Viewpoint%20Planner/TARE%E7%94%A8%E4%BA%8E%E7%9C%9F%E5%AE%9E%E6%9C%BA%E5%99%A8%E4%BA%BA/">TARE用于真实机器人</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2021-12-11</time><span class="article-meta"><span class="article-meta__separator">|</span><i class="fa fa-inbox article-meta__icon" aria-hidden="true"></i><a class="article-meta__categories" href="/categories/%E8%B7%AF%E5%BE%84%E8%A7%84%E5%88%92/">路径规划</a><i class="fa fa-angle-right" aria-hidden="true"></i><i class="fa fa-inbox article-meta__icon" aria-hidden="true"></i><a class="article-meta__categories" href="/categories/%E8%B7%AF%E5%BE%84%E8%A7%84%E5%88%92/Dual-Stage-Viewpoint-Planner/">Dual-Stage Viewpoint Planner</a></span><div class="content"><p>对于<code>system_real_robot.launch</code>，就是把<code>system_garage.launch</code>中的 <code>vehicle_simulator.launch</code> 和 <code>visualization_tools.launch</code>换成了 <code>loam_interface.launch</code></p>
<p>对于<code>LeGO-LOAM</code>，将<code>loam_interface.launch</code>中的 <code>registeredScanTopic</code>设置为</p>
<h3 id="启动时的报错"><a href="#启动时的报错" class="headerlink" title="启动时的报错"></a>启动时的报错</h3><p><img src="https://s2.loli.net/2021/12/13/W2oQPEm4Ky8UfwB.png" alt="启动时的报错"><br>这里是缺<code>diagnostic_aggregator</code>包，我开始以为这个包是TARE自带的，后来发现要自己安装，去Github下载即可，其实<strong>不装也可以，从launch里删掉这段也可</strong>。 这个包不必深入研究，它是从系统中收集各种状态信息和硬件信息，比如电机驱动器、SICK激光扫描仪、Videre摄像机和几个电池的诊断信息</p>
<p>后面的Joystick报警不必理会，要保证有<code>/dev/input/js0</code>，如果没有手柄，就不要启动<code>ps3.launch</code></p>
<p>参考：<br><a target="_blank" rel="noopener" href="http://wiki.ros.org/diagnostic_aggregator">diagnostic_aggregator</a><br><a target="_blank" rel="noopener" href="https://blog.csdn.net/xu_fengyu/article/details/90523459">ROS中的diagnostics模块</a></p>
<h3 id="cmd-vel-类型错误"><a href="#cmd-vel-类型错误" class="headerlink" title="cmd_vel 类型错误"></a>cmd_vel 类型错误</h3><p>启动<code>system_real_robot.launch</code>后的<code>cmd_vel</code>报错<br><img src="https://s2.loli.net/2021/12/13/d4yOLwBWPzYSsDa.png" alt="报错"></p>
<p>这两个消息类型的MD5当然不同<br><img src="https://s2.loli.net/2021/12/13/vQyaC6lfs8R2z3d.png" alt=""><br><img src="https://s2.loli.net/2021/12/13/7UL9F5ivwCtubkz.png" alt=""></p>
<p>结果发现，在启动launch之前，订阅的<code>cmd_vel</code>还是<code>Twist</code>，启动launch之后就变成了<code>TwistStamped</code>，这个覆盖消息类型的现象倒是没见过<br><img src="https://s2.loli.net/2021/12/13/28dkclsbPAyqRga.png" alt=""></p>
<p>修改<code>local_planner\src\pathFollower.cpp</code>中的发布部分<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ros::Publisher pubSpeed = nh.advertise&lt;geometry_msgs::TwistStamped&gt; (<span class="string">&quot;/cmd_vel&quot;</span>, <span class="number">5</span>);</span><br><span class="line">geometry_msgs::TwistStamped cmd_vel;</span><br></pre></td></tr></table></figure><br>修改<code>TwistStamped</code>为<code>Twist</code>，下面的<code>cmd_vel</code>就没有了<code>twist</code>成员，变量的几次赋值也需要修改。</p>
<h2 id="tf设置"><a href="#tf设置" class="headerlink" title="tf设置"></a>tf设置</h2><p><img src="https://s2.loli.net/2021/12/13/tpr21lKPm4856hA.png" alt="仿真下的tf"></p>
<p><img src="https://s2.loli.net/2021/12/13/GycNpbOFBfrCoiW.png" alt="真车第一次的tf"></p>
<h2 id="参数"><a href="#参数" class="headerlink" title="参数"></a>参数</h2><p>调整<code>local_planner.launch</code>中的参数<code>obstacleHeightThre</code> to account for terrain cloud thickness</p>
<p><img src="https://s2.loli.net/2021/12/11/7cKtkGTXH2vEs6f.png" alt=""></p>
</div><hr></div><div class="recent-post-item article-container"><a class="article-title" href="/2021/12/11/%E8%B7%AF%E5%BE%84%E8%A7%84%E5%88%92/%E5%BC%A0%E6%A5%ABDual-Stage%20Viewpoint%20Planner/TARE%E5%9C%A8%E4%BB%BF%E7%9C%9F%E7%8E%AF%E5%A2%83/">TARE在仿真环境的运行</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2021-12-11</time><span class="article-meta"><span class="article-meta__separator">|</span><i class="fa fa-inbox article-meta__icon" aria-hidden="true"></i><a class="article-meta__categories" href="/categories/%E8%B7%AF%E5%BE%84%E8%A7%84%E5%88%92/">路径规划</a><i class="fa fa-angle-right" aria-hidden="true"></i><i class="fa fa-inbox article-meta__icon" aria-hidden="true"></i><a class="article-meta__categories" href="/categories/%E8%B7%AF%E5%BE%84%E8%A7%84%E5%88%92/Dual-Stage-Viewpoint-Planner/">Dual-Stage Viewpoint Planner</a></span><div class="content"><p>搭建了五种仿真环境，室内环境/校园/停车场/隧道以及森林。</p>
<ul>
<li><p>校园环境(340m x 340m): 根据卡内基梅隆大学的部分校园环境重建得到，包含一些上下坡以及盘绕的地形。</p>
</li>
<li><p>室内环境(130m x 100m): 包含长且窄的走廊以及许多桌子/椅子等障碍物，其中还有一个护栏，由于其中间可以穿透的特性，会对机器人的感知（perception）模块增加挑战性。</p>
</li>
<li><p>停车场(140m x 130m, 5层): 包含多层楼且有上下坡，会对机器人3D导航任务增加难度</p>
</li>
<li><p>隧道(330m x 250m): 错综复杂的隧道构成的一个庞大的网格结构</p>
</li>
<li><p>森林(150m x 150m): 包含无规律分布的树木以及几栋房子。</p>
</li>
</ul>
<p>仿真平台暂时不支持车在崎岖路面上的行驶的动态模拟（车轮和路面的接触之类的）。</p>
<h3 id="Simulation-Environments"><a href="#Simulation-Environments" class="headerlink" title="Simulation Environments"></a>Simulation Environments</h3><p>进入<code>src/vehicle_simulator/launch</code>，运行不同环境的launch，比如<br><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">roslaunch vehicle_simulator system_garage.launch</span><br></pre></td></tr></table></figure><br>还可以换成<code>system_indoor.launch</code>等等</p>
<p>使用<strong>Waypoint</strong> button in RVIZ 进行导航。为了在Gazebo观察, 设置launch文件中的<code>gazebo_gui = true</code> </p>
<p>环境文件在<code>src/vehicle_simulator/meshes</code>. <code>preview</code>文件夹中的<code>pointcloud.ply</code>是地图的点云文件，可使用 CloudCompare and MeshLab 打开。</p>
<h2 id="运行出现的问题"><a href="#运行出现的问题" class="headerlink" title="运行出现的问题"></a>运行出现的问题</h2><p>在虚拟机下运行gazebo，得到<font color = orange size=4> vmw_ioctl_command error Invalid argument</font>错误<br>解决方法是在终端下设置环境变量为0：<code>export SVGA_VGPU10=0</code>， 再加入环境变量</p>
<p><br></p>
<p>打开gazebo报错 [Err] <font color = orange size=4> [REST.cc:205] Error in REST request</font> </p>
<p>执行<code>sudo gedit ~/.ignition/fuel/config.yaml</code>， 然后将<code>url : https://api.ignitionfuel.org</code> 改为 <code>url: https://api.ignitionrobotics.org</code></p>
<p><br><br><img src="https://i.loli.net/2021/11/22/tVlSzcPmNK7vWZu.png" alt="打开gazebo_ros出错.png"></p>
<h2 id="vehicle-simulator-launch"><a href="#vehicle-simulator-launch" class="headerlink" title="vehicle_simulator.launch"></a>vehicle_simulator.launch</h2><p><code>vehicle_simulator.launch</code>除了Gazebo那堆东西外，还有一个<code>vehicleSimulator</code>节点，发布<code>map ---&gt; sensor</code>转换。 发布话题: </p>
<ul>
<li>gazebo/set_model_state [gazebo_msgs/ModelState]</li>
<li>registered_scan [sensor_msgs/PointCloud2]</li>
<li>state_estimation [nav_msgs/Odometry]</li>
<li>tf [tf2_msgs/TFMessage]</li>
</ul>
<p>订阅话题: </p>
<ul>
<li>cmd_vel (50Hz)， path following 模块，用于发速度命令</li>
<li>terrain_map [sensor_msgs/PointCloud2]</li>
<li>velodyne_points [sensor_msgs/PointCloud2]</li>
</ul>
<p>激光是基于Velodyne VLP-16进行模拟的，话题<code>registered_scan</code>，类型<code>sensor_msgs/PointCloud2</code>，频率5Hz，坐标系是<code>map</code>。 订阅者：</p>
<ul>
<li>terrainAnalysisExt</li>
<li>sensorScanGeneration</li>
<li>localPlanner</li>
<li>terrainAnalysis</li>
<li>visualizationTools</li>
</ul>
<p>话题<code>state_estimation</code>其实就是里程计，频率200Hz，从<code>map</code>坐标系到<code>sensor</code>坐标系。但<code>twist</code>部分一直都是0<br><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">header: </span><br><span class="line">  seq: <span class="number">51875</span></span><br><span class="line">  stamp: </span><br><span class="line">    secs: <span class="number">262</span></span><br><span class="line">    nsecs: <span class="number">430000000</span></span><br><span class="line">  frame_id: <span class="string">&quot;/map&quot;</span></span><br><span class="line">child_frame_id: <span class="string">&quot;/sensor&quot;</span></span><br><span class="line">pose: </span><br><span class="line">  pose: </span><br><span class="line">    position: </span><br><span class="line">      x: <span class="number">2.87540912628</span></span><br><span class="line">      y: <span class="number">0.187103256583</span></span><br><span class="line">      z: <span class="number">0.711781859398</span></span><br><span class="line">    orientation: </span><br><span class="line">      x: <span class="number">0.00766504419326</span></span><br><span class="line">      y: <span class="number">0.00128535269673</span></span><br><span class="line">      z: <span class="number">0.0567104408485</span></span><br><span class="line">      w: <span class="number">0.998360416315</span></span><br><span class="line">  covariance: [<span class="number">0.0</span>, <span class="number">0.0</span>, <span class="number">0.0</span>, <span class="number">0.0</span>, <span class="number">0.0</span>, <span class="number">0.0</span>, <span class="number">0.0</span>, <span class="number">0.0</span>, <span class="number">0.0</span>, <span class="number">0.0</span>, <span class="number">0.0</span>, <span class="number">0.0</span>, <span class="number">0.0</span>, <span class="number">0.0</span>, <span class="number">0.0</span>, <span class="number">0.0</span>, <span class="number">0.0</span>, <span class="number">0.0</span>, <span class="number">0.0</span>, <span class="number">0.0</span>, <span class="number">0.0</span>, <span class="number">0.0</span>, <span class="number">0.0</span>, <span class="number">0.0</span>, <span class="number">0.0</span>, <span class="number">0.0</span>, <span class="number">0.0</span>, <span class="number">0.0</span>, <span class="number">0.0</span>, <span class="number">0.0</span>, <span class="number">0.0</span>, <span class="number">0.0</span>, <span class="number">0.0</span>, <span class="number">0.0</span>, <span class="number">0.0</span>, <span class="number">0.0</span>]</span><br><span class="line"><span class="comment"># 省略twist</span></span><br></pre></td></tr></table></figure></p>
<p>Low-frequency state estimation (5Hz): ‘nav_msgs::Odometry’ typed messages on ROS topic ‘/state_estimation_at_scan’, synchronized with ‘/sensor_scan’ messages, from ‘map’ frame to ‘sensor_at_scan’ frame.</p>
<h2 id="sensor-scan-generation-launch"><a href="#sensor-scan-generation-launch" class="headerlink" title="sensor_scan_generation.launch"></a>sensor_scan_generation.launch</h2><p><code>sensor_scan_generation.launch</code>就是把这<code>state_estimation</code> 和 <code>registered_scan</code>这两个话题做ROS时间戳同步，将<code>map</code>坐标系的点云<code>state_estimation</code>转为<code>sensor_at_scan</code>坐标系的<code>sensor_scan</code> (5Hz)。发布二者的tf变化，但是转换的矩阵是左乘<code>transformToMap</code>，它来自里程计，没理解为什么。</p>
<h2 id="Visualization-Tools"><a href="#Visualization-Tools" class="headerlink" title="Visualization Tools"></a>Visualization Tools</h2><p><code>visualization_tools.launch</code>包括<code>realTimePlot.py</code> 和 <code>visualizationTools.cpp</code>。 <code>realTimePlot.py</code>就是窗口程序<code>Figure 1</code>，后者就是节点<code>visualizationTools</code>：<br>Publications: </p>
<ul>
<li>explored_areas [sensor_msgs/PointCloud2]</li>
<li>explored_volume [std_msgs/Float32]</li>
<li>overall_map [sensor_msgs/PointCloud2]</li>
<li>time_duration [std_msgs/Float32]</li>
<li>trajectory [sensor_msgs/PointCloud2]</li>
<li>traveling_distance [std_msgs/Float32]</li>
</ul>
<p>Subscriptions: </p>
<ul>
<li>clock [rosgraph_msgs/Clock]</li>
<li>registered_scan [sensor_msgs/PointCloud2]</li>
<li>runtime [unknown type]</li>
<li>state_estimation [nav_msgs/Odometry]</li>
</ul>
<p>为了观察算法的能力。RVIZ的<code>Panels-&gt;Displays</code>可以选择’overallMap’, ‘exploredAreas’, and ‘trajectory’。对应overall map of the environment, explored areas, and vehicle trajectory</p>
<p>窗口<code>Figure 1</code>实时地观察 <code>explored volume</code>, <code>traveling distance</code>, and <code>algorithm runtime</code>。 如果要绘制runtime曲线, users need to send the numbers as messages on the ROS topic below.</p>
<p>Runtime: ‘std_msgs::Float32’ typed messages on ROS topic ‘/runtime’.</p>
<p>但是我运行程序时，这三个指标曲线都没出现。</p>
<p>运行的最后，recorded metrics保存在文件<code>src/vehicle_simulator/log</code>, 以及vehicle trajectory. Note that due to the heavy CPU load of Gazebo, the real-time factor is &lt; 1 - the simulated clock is slower than the real clock. Here, we refer to the simulated clock in recording time duration of the run since it is less affected by the clock speed on different computers. The best human practice results can be downloaded.</p>
<h2 id="local-planner-launch"><a href="#local-planner-launch" class="headerlink" title="local_planner.launch"></a>local_planner.launch</h2><p><code>local_planner.launch</code>包括节点<code>localPlanner</code>和<code>pathFollower</code>，以及发布<code>sensor ---&gt; vehicle</code> 和 <code>sensor ---&gt; camera</code>的tf变换</p>
</div><hr></div><div class="recent-post-item article-container"><a class="article-title" href="/2021/12/07/%E8%B7%AF%E5%BE%84%E8%A7%84%E5%88%92/%E5%BC%BA%E5%8C%96%E5%AD%A6%E4%B9%A0%20%E5%BC%80%E5%A7%8B/">强化学习 开始</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2021-12-07</time><span class="article-meta"><span class="article-meta__separator">|</span><i class="fa fa-inbox article-meta__icon" aria-hidden="true"></i><a class="article-meta__categories" href="/categories/%E8%B7%AF%E5%BE%84%E8%A7%84%E5%88%92/">路径规划</a><i class="fa fa-angle-right" aria-hidden="true"></i><i class="fa fa-inbox article-meta__icon" aria-hidden="true"></i><a class="article-meta__categories" href="/categories/%E8%B7%AF%E5%BE%84%E8%A7%84%E5%88%92/%E5%85%B6%E4%BB%96/">其他</a></span><div class="content"><p>强化学习主要包括基于值函数方法和策略搜索方法两类，如 Q 学习算法，SARSA算法、策略梯度(Policy Gradient)算法和演员-评论家(Actor-Critic)算法。</p>
<ul>
<li><p>演员-评论家 (Actor-Critic)</p>
</li>
<li><p>DQN：基于值函数的方法，在Q-Learning算法基础上，加入深度神经网络和记忆回放。之后很多的基于值函数的深度强化学习方法都以此方法为基础进行的改进</p>
</li>
<li><p>DPG: 将策略梯度方法与深度学习结合提出了确定性策略梯度方法，解决了 DQN 算法在连续动作上无法进行有效学习的不足</p>
</li>
<li><p>DDPG: 在 Actor-Critic 框架的基础上将 DPG 算法和 DQN 算法结合，提出了深度确定性策略梯度（Deep Deterministic Policy Gradient, DDPG）算法，DDPG 算法可以更好的在连续性的动作上做出决策。</p>
</li>
<li><p>TRPO: 信任域策略优化（Trust Region Policy Optimization, TRPO）用来解决策略梯度算法更新步长难以确定导致的收敛速度问题，TRPO使用的是二阶展开的方法对参数进行求解，但二阶展开的方法会产生很大的计算量</p>
</li>
<li><p>PPO: 针对TRPO的计算量问题， Schulman 等人提出了仅使用一阶梯度的方法的近端策略优化 (Proximal Policy Optimization, PPO) 算法。</p>
</li>
</ul>
<p>复杂环境下，传统强化学习会产生很大的计算量，不能用于实时的路径规划。</p>
<p>一系列深度强化学习算法在深度神经网络训练好的前提下可以很好地完成对机器人移动路径的规划， 但神经网络的训练速度还是过于缓慢，如何提升深度强化学习的训练速度和在路径规划过程中的准确率是一个亟待解决的问题。</p>
</div><hr></div><div class="recent-post-item article-container"><a class="article-title" href="/2021/12/04/%E8%B7%AF%E5%BE%84%E8%A7%84%E5%88%92/move_base%20%E5%88%86%E6%9E%90/%E4%B8%BA%E4%BB%80%E4%B9%88%E8%AF%B4move_base%E6%A1%86%E6%9E%B6%E4%B8%8D%E9%80%82%E5%90%883D%E5%AF%BC%E8%88%AA/">为什么说move_base框架不适合3D导航</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2021-12-04</time><span class="article-meta"><span class="article-meta__separator">|</span><i class="fa fa-inbox article-meta__icon" aria-hidden="true"></i><a class="article-meta__categories" href="/categories/%E8%B7%AF%E5%BE%84%E8%A7%84%E5%88%92/">路径规划</a><i class="fa fa-angle-right" aria-hidden="true"></i><i class="fa fa-inbox article-meta__icon" aria-hidden="true"></i><a class="article-meta__categories" href="/categories/%E8%B7%AF%E5%BE%84%E8%A7%84%E5%88%92/move-base%E5%88%86%E6%9E%90/">move_base分析</a></span><div class="content"><h2 id="检测高度难以调整"><a href="#检测高度难以调整" class="headerlink" title="检测高度难以调整"></a>检测高度难以调整</h2><p>多线雷达安装在一定高度，地面上有个比较矮的障碍物，要在代价地图里添加。这显然涉及参数<code>min_obstacle_height</code>，要将其降低<br><img src="https://i.loli.net/2021/12/01/mur2JIHZTMzqh4L.png" alt="-0.5 未检测到低处障碍"><br><img src="https://i.loli.net/2021/12/01/OeVamTkJGvq2NdX.png" alt="-0.55 检测到障碍，但不合理"><br>只稍微降低了<code>min_obstacle_height</code>，虽然是检测到了，但是个环形，这跟多线雷达数据的形状一样，所以认为其实是检测到了地面。</p>
<p>这里发现代价地图能做的修改其实很少了，主要在LOAM和<code>octomap_server</code>了</p>
<h2 id="检测距离不能太大"><a href="#检测距离不能太大" class="headerlink" title="检测距离不能太大"></a>检测距离不能太大</h2><p>这说的是<code>obstacle_range</code>，如果太大，局部代价地图的窗口的四角都会出现障碍，不知是怎么添加进来的。</p>
<h2 id="代价地图添加了太多不需要的点云数据"><a href="#代价地图添加了太多不需要的点云数据" class="headerlink" title="代价地图添加了太多不需要的点云数据"></a>代价地图添加了太多不需要的点云数据</h2><p>对于多线雷达，点云数据量比单线大了很多，在检测近处障碍的时候，计算<code>sq_dist</code>会得到很多点(虽然delta_z不是0)。单线雷达扫描的是一条线，多线其实是很多条线，但是代价地图是2D的，投影会有很多重复的，需要针对xy坐标去重，显著降低了效率，这又是<code>costmap_2d</code>不适合多线雷达的一个例子。</p>
<p>这种情况下，增大的网络占用已经不能忽略了，不能开Rviz，否则会大大影响到导航。</p>
</div><hr></div><div class="recent-post-item article-container"><a class="article-title" href="/2021/12/04/ROS/ROS%20Kinetic%E7%9F%A5%E8%AF%86/Gazebo%E7%9A%84%E4%BD%BF%E7%94%A8%E9%85%8D%E7%BD%AE/">Gazebo的使用配置</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2021-12-04</time><span class="article-meta"><span class="article-meta__separator">|</span><i class="fa fa-inbox article-meta__icon" aria-hidden="true"></i><a class="article-meta__categories" href="/categories/ROS/">ROS</a><i class="fa fa-angle-right" aria-hidden="true"></i><i class="fa fa-inbox article-meta__icon" aria-hidden="true"></i><a class="article-meta__categories" href="/categories/ROS/ROS-Kinetic%E7%9F%A5%E8%AF%86/">ROS Kinetic知识</a></span><div class="content"><p>利用<code>spawn_model</code>脚本向<code>gazebo_ros</code>节点（在主题中，空间名为 <code>gazebo</code>）发出服务请求，进而添加 URDF 到 Gazebo 中<br><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rosrun gazebo_ros spawn_model -file `rospack find MYROBOT_description`/urdf/MYROBOT.urdf -urdf -x 0 -y 0 -z 1 -model MYROBOT</span><br></pre></td></tr></table></figure><br>如果是.xacro，可以转化为 urdf 文件：</p>
<h2 id="xacro转urdf"><a href="#xacro转urdf" class="headerlink" title="xacro转urdf"></a>xacro转urdf</h2><p>如果是kinetic，执行<br><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rosrun xacro xacro.py robot1.xacro &gt; robot1_processed.urdf</span><br></pre></td></tr></table></figure><br>会得到：<br><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">xacro: Traditional processing is deprecated. Switch to --inorder processing!</span><br><span class="line">To check <span class="keyword">for</span> compatibility of your document, use option --check-order.</span><br><span class="line">For more infos, see http://wiki.ros.org/xacro<span class="comment">#Processing_Order xacro.py is deprecated; please use xacro instead</span></span><br></pre></td></tr></table></figure><br>说明<code>xacro.py</code>命令已经过期，使用xacro替换： <code>rosrun xacro xacro robot1.xacro &gt; robot1_processed.urdf</code></p>
<p><br></p>
<p>如果是在Melodic，执行<code>rosrun xacro xacro --inorder $(locate robot.urdf.xacro) &gt; robot_inorder.urdf</code>，结果得到<br><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">xacro: in-order processing became default <span class="keyword">in</span> ROS Melodic. You can drop the option.</span><br></pre></td></tr></table></figure></p>
<h2 id="查看关节图"><a href="#查看关节图" class="headerlink" title="查看关节图"></a>查看关节图</h2><p>先执行<code>sudo apt install -y liburdfdom-tools</code><br><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">check_urdf pr2.urdf</span><br><span class="line"><span class="comment"># 再打开转换的pdf</span></span><br><span class="line">urdf_to_graphiz pr2.urdf</span><br></pre></td></tr></table></figure></p>
<p>查看<code>spawn_model</code>的所有参数，可以运行：<br><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rosrun gazebo_ros spawn_model -h</span><br></pre></td></tr></table></figure></p>
<p>在 launch文件中，对于<code>urdf</code>可以这样编写：<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- Spawn a robot into Gazebo --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">node</span> <span class="attr">name</span>=<span class="string">&quot;spawn_urdf&quot;</span> <span class="attr">pkg</span>=<span class="string">&quot;gazebo_ros&quot;</span> <span class="attr">type</span>=<span class="string">&quot;spawn_model&quot;</span> <span class="attr">args</span>=<span class="string">&quot;-file $(find baxter_description)/urdf/baxter.urdf -urdf -z 1 -model baxter&quot;</span> /&gt;</span></span><br></pre></td></tr></table></figure></p>
<p>对于<code>xacro</code>，这样编写:<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- Convert an xacro and put on parameter server --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">param</span> <span class="attr">name</span>=<span class="string">&quot;robot_description&quot;</span> <span class="attr">command</span>=<span class="string">&quot;$(find xacro)/xacro.py $(find pr2_description)/robots/pr2.urdf.xacro&quot;</span> /&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- Spawn a robot into Gazebo --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">node</span> <span class="attr">name</span>=<span class="string">&quot;spawn_urdf&quot;</span> <span class="attr">pkg</span>=<span class="string">&quot;gazebo_ros&quot;</span> <span class="attr">type</span>=<span class="string">&quot;spawn_model&quot;</span> <span class="attr">args</span>=<span class="string">&quot;-param robot_description -urdf -model pr2&quot;</span> /&gt;</span></span><br></pre></td></tr></table></figure></p>
<p>URDF的报错原因：加了<visual><geometry>等标签，但没加具体内容。<br><img src="https://i.loli.net/2021/11/23/KmEJrNVjgsU3961.png" alt=""><br><code>rosrun gazebo_ros spawn_model -file robot.urdf -urdf -model robot</code></p>
<p>sdf: standard definition of world for Gazebo</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">launch</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">include</span> <span class="attr">file</span>=<span class="string">&quot;$(find gazebo_ros)/launch/empty_world.launch&quot;</span> &gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">include</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">arg</span> <span class="attr">name</span>=<span class="string">&#x27;robot_urdf&#x27;</span> <span class="attr">default</span>=<span class="string">&quot;$(find xacro)/xacro &#x27;$(find vehicle_simulator)/urdf/robot.urdf.xacro&#x27;&quot;</span> /&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">param</span> <span class="attr">name</span>=<span class="string">&quot;robot_description&quot;</span> <span class="attr">command</span>=<span class="string">&quot;$(arg robot_urdf)&quot;</span> /&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">node</span> <span class="attr">pkg</span>=<span class="string">&quot;gazebo_ros&quot;</span> <span class="attr">type</span>=<span class="string">&quot;spawn_model&quot;</span> <span class="attr">name</span>=<span class="string">&quot;spawn_robot&quot;</span> <span class="attr">args</span>=<span class="string">&quot;-urdf -param robot_description -model robot -x 0 -y 0 -z 0.5&quot;</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">node</span> <span class="attr">pkg</span>=<span class="string">&quot;teleop_twist_keyboard&quot;</span> <span class="attr">type</span>=<span class="string">&quot;teleop_twist_keyboard.py&quot;</span> <span class="attr">name</span>=<span class="string">&quot;teleop&quot;</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">launch</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p><img src="https://i.loli.net/2021/11/24/culyfF2MdLzjrO7.png" alt="正常的输出信息.png"></p>
<p>Gazebo的<code>gui</code>参数经常是false，这是因为显示界面会显著加大资源占用</p>
</div><hr></div><div class="recent-post-item article-container"><a class="article-title" href="/2021/11/27/ROS/ROS%20Kinetic%E7%9F%A5%E8%AF%86/rqt_plot%E7%9A%84%E6%9B%BF%E4%BB%A3%E5%93%81%20plotjuggler/">rqt_plot的替代品 plotjuggler</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2021-11-27</time><span class="article-meta"><span class="article-meta__separator">|</span><i class="fa fa-inbox article-meta__icon" aria-hidden="true"></i><a class="article-meta__categories" href="/categories/ROS/">ROS</a><i class="fa fa-angle-right" aria-hidden="true"></i><i class="fa fa-inbox article-meta__icon" aria-hidden="true"></i><a class="article-meta__categories" href="/categories/ROS/ROS-Kinetic%E7%9F%A5%E8%AF%86/">ROS Kinetic知识</a></span><div class="content"><p>安装: <code>sudo apt-get install -y ros-melodic-plotjuggler-ros</code>，运行 <code>rosrun plotjuggler plotjuggler</code></p>
</div><hr></div><div class="recent-post-item article-container"><a class="article-title" href="/2021/11/27/%E8%B7%AF%E5%BE%84%E8%A7%84%E5%88%92/move_base%20%E5%88%86%E6%9E%90/move_base%E7%9A%84CPU%E5%8D%A0%E7%94%A8%E5%92%8C%E4%B8%A4%E4%B8%AA%E5%B8%B8%E8%A7%81%E6%8A%A5%E8%AD%A6/">move_base的CPU占用和两个常见报警</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2021-11-27</time><span class="article-meta"><span class="article-meta__separator">|</span><i class="fa fa-inbox article-meta__icon" aria-hidden="true"></i><a class="article-meta__categories" href="/categories/%E8%B7%AF%E5%BE%84%E8%A7%84%E5%88%92/">路径规划</a><i class="fa fa-angle-right" aria-hidden="true"></i><i class="fa fa-inbox article-meta__icon" aria-hidden="true"></i><a class="article-meta__categories" href="/categories/%E8%B7%AF%E5%BE%84%E8%A7%84%E5%88%92/move-base%E5%88%86%E6%9E%90/">move_base分析</a></span><div class="content">abstract Welcome to my blog, enter password to read.</div><a class="more" href="/2021/11/27/%E8%B7%AF%E5%BE%84%E8%A7%84%E5%88%92/move_base%20%E5%88%86%E6%9E%90/move_base%E7%9A%84CPU%E5%8D%A0%E7%94%A8%E5%92%8C%E4%B8%A4%E4%B8%AA%E5%B8%B8%E8%A7%81%E6%8A%A5%E8%AD%A6/#more">Read more</a><hr></div><div class="recent-post-item article-container"><a class="article-title" href="/2021/11/22/%E8%B7%AF%E5%BE%84%E8%A7%84%E5%88%92/%E5%BC%A0%E6%A5%ABDual-Stage%20Viewpoint%20Planner/DSVP%E7%9A%84%E4%BB%8B%E7%BB%8D%E5%92%8C%E8%BF%90%E8%A1%8C/">DSVP的介绍和运行</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2021-11-22</time><span class="article-meta"><span class="article-meta__separator">|</span><i class="fa fa-inbox article-meta__icon" aria-hidden="true"></i><a class="article-meta__categories" href="/categories/%E8%B7%AF%E5%BE%84%E8%A7%84%E5%88%92/">路径规划</a><i class="fa fa-angle-right" aria-hidden="true"></i><i class="fa fa-inbox article-meta__icon" aria-hidden="true"></i><a class="article-meta__categories" href="/categories/%E8%B7%AF%E5%BE%84%E8%A7%84%E5%88%92/Dual-Stage-Viewpoint-Planner/">Dual-Stage Viewpoint Planner</a></span><div class="content"><p>Dual-Stage Viewpoint Planner 包含两个阶段：探索阶段用于扩展地图边界，重定位阶段用于 explicitly 把机器人传到环境中不同的子区域。探索阶段采用RRT，并动态地扩展RRT over replanning steps. 重定位阶段维护一个graph结构 through the mapped environment. 在探索过程中，算法在两个阶段来回切换，以探索整个环境。</p>
<p>DSVP有几个上层规划算法，包括在未知环境中的探索算法和全局路径规划算法，以及全套算法的系统集成和扩展应用。</p>
<p>我们提供的避障算法优势在于能实时高效地应对复杂环境,同时最大化到达目标点的概率。算法的主要思想在于尽可能地让计算在线下完成。具体来说，一个避障算法最耗时的计算一般在于检测机器人在未来时间点与环境发生碰撞的可能。我们的算法先通过离线生成一个庞大的轨迹库（trajectory library）来模拟机器人在未来一段时间内可能走过的轨迹。接下来对于所有轨迹覆盖的空间，我们计算其内部所有点（在一定解析度下）与所有轨迹发生碰撞的可能性。经过这样的离线计算，我们可以得到一个空间内3D点到轨迹的对应关系。在实时运行的过程中，一旦空间内的某个点上有障碍物，我们可以马上知道哪些轨迹将会受到影响。我们的算法会降低选择这些轨迹作为最终路径的可能性。因为大量的计算都在线下进行，线上运行的时候只需要实时选择无碰撞的轨迹，我们的算法可以在几毫秒之内规划出一条无碰撞而最接近目标点的路径。</p>
<p>测试平台是野外机器人，车上用了velodyne-16激光雷达，xsens mti-200 imu。速度只能达到2m/s。运行系统要求是18.04或者20.04</p>
<p>TARE系统有使用多线激光点云做地面分割，来判断哪些高度的地方可以去，哪些不能去，以应对有坡度、崎岖的地面。 系统里维护的是3d octomap</p>
<p>只是把点云数据register到了全局坐标系下，然后把局部的点云叠加起来先做地形分析再用地形图做避障和导航。</p>
<p><code>roslaunch waypoint_example waypoint_example_garage.launch</code></p>
<p>Alternatively, users can run a ROS node to send a series of waypoints. The ROS node sends navigation boundary and speed as well. The vehicle will navigate inside the boundary while following the waypoints.</p>
<h2 id="Autonomous-Navigation-Modules"><a href="#Autonomous-Navigation-Modules" class="headerlink" title="Autonomous Navigation Modules"></a>Autonomous Navigation Modules</h2><p>Sending waypoints, navigation boundary, and speed: Upon receiving waypoint, navigation boundary, and speed messages, the system will navigate the vehicle inside the navigation boundary to the waypoint. Sending navigation boundary and speed is optional. The default speed in the system is set to 2m/s. Users can take the code in the ‘waypoint_example’ package as an example of sending these messages.</p>
<ul>
<li><p>Waypoint: 话题<code>way_point</code>，<code>geometry_msgs::PointStamped</code>类型的消息，在<code>map</code>坐标系。 发布者当然是<code>rvizGA</code> 和 <code>localPlanner</code> 和 <code>rvizGA</code></p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">header: </span><br><span class="line">  seq: 6</span><br><span class="line">  stamp: </span><br><span class="line">    secs: 215</span><br><span class="line">    nsecs: 380000000</span><br><span class="line">  frame_id: <span class="string">&quot;map&quot;</span></span><br><span class="line">point: </span><br><span class="line">  x: 9.90468215942</span><br><span class="line">  y: 12.2474937439</span><br><span class="line">  z: 0.839443683624</span><br><span class="line">---</span><br><span class="line">header: </span><br><span class="line">  seq: 7</span><br><span class="line">  stamp: </span><br><span class="line">    secs: 215</span><br><span class="line">    nsecs: 380000000</span><br><span class="line">  frame_id: <span class="string">&quot;map&quot;</span></span><br><span class="line">point: </span><br><span class="line">  x: 9.90468215942</span><br><span class="line">  y: 12.2474937439</span><br><span class="line">  z: 0.839443683624</span><br></pre></td></tr></table></figure>
</li>
<li><p>Navigation boundary (optional): 话题<code>navigation_boundary</code>，<code>geometry_msgs::PolygonStamped</code>的消息， 在<code>map</code>坐标系。 <strong>默认没有发布</strong>，订阅者是<code>localPlanner</code></p>
</li>
<li><p>速度 (optional): 话题<code>speed</code>，消息为<code>std_msgs::Float32</code>类型。 <strong>默认没有发布</strong>，订阅者是<code>pathFollower</code>和<code>localPlanner</code></p>
</li>
<li><p>避障: The collision avoidance is handled by the ‘local_planner’ package. The package computes collision-free paths to guide the vehicle through the environment. Motion primitives are pre-generated and loaded into the system upon start. When the vehicle navigates, the system in real-time determines the motion primitives occluded by obstacles. Those motion primitives are eliminated and the collision-free paths are selected. In the image below, the coordinate frame indicates the vehicle and the yellow dots are collision-free paths. In an autonomous navigation system, the collision avoidance module should be guided by a high-level planning module, e.g. a route planner that sends waypoints in the vicinity of the vehicle along the route. The collision avoidance module uses terrain maps from the ‘terrain_analysis’ package to determine terrain traversability (information below).</p>
</li>
<li><p>Terrain traversability analysis: The ‘terrain_analysis’ package analyzes the local smoothness of the terrain and associates a cost to each point on the terrain map. The system publishes terrain map messages where each message contains a set of ‘pcl::PointXYZI’ typed points. The x, y, and z fields of a point indicate the coordinates and the intensity field stores the cost. The terrain map covers a 10m x 10m area with the vehicle in the center. Further, the ‘terrain_analysis_ext’ package extends the terrain map to a 40m x 40m area. The extended terrain map keeps lidar points over a sliding window of 10 seconds with a non-decay region within 4m from the vehicle. In an autonomous navigation system, the terrain map is used by the collision avoidance module (information above) and the extended terrain map is to be used by a high-level planning module. To view the terrain map or the extended terrain map in RVIZ, click ‘Panels-&gt;Displays’ and check ‘terrainMap’ or ‘terrainMapExt’. The green points are traversable and the red points are non-traversable.</p>
</li>
<li><p>Terrain map (5Hz): ‘sensor_msgs::PointCloud2’ typed messages on ROS topic ‘/terrain_map’, in ‘map’ frame.</p>
</li>
</ul>
<p>Publishers:<br>terrainAnalysis</p>
<p>Subscribers:<br>terrainAnalysisExt<br>localPlanner<br>vehicleSimulator</p>
<ul>
<li>Extended terrain map (5Hz): ‘sensor_msgs::PointCloud2’ typed messages on ROS topic ‘/terrain_map_ext’, in ‘map’ frame.  发布者 <code>/terrainAnalysisExt</code></li>
</ul>
<p>Waypoint following: Upon receiving a waypoint, the system guides the vehicle to the waypoint. For information on tuning path following control, i.e. speed, yaw rate, acceleration, look-ahead distance, gains, and changing vehicle size, please refer to Ground-based Autonomy Base Repository.</p>
</div><hr></div><div class="recent-post-item article-container"><a class="article-title" href="/2021/11/18/%E8%B7%AF%E5%BE%84%E8%A7%84%E5%88%92/%E5%85%A8%E5%B1%80%E8%B7%AF%E5%BE%84/%E5%85%A8%E5%B1%80%E8%B7%AF%E5%BE%84%E6%97%A0%E6%B3%95%E8%B5%B0%E5%87%BA%E9%9A%9C%E7%A2%8D/">全局路径无法走出障碍</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2021-11-18</time><span class="article-meta"><span class="article-meta__separator">|</span><i class="fa fa-inbox article-meta__icon" aria-hidden="true"></i><a class="article-meta__categories" href="/categories/%E8%B7%AF%E5%BE%84%E8%A7%84%E5%88%92/">路径规划</a><i class="fa fa-angle-right" aria-hidden="true"></i><i class="fa fa-inbox article-meta__icon" aria-hidden="true"></i><a class="article-meta__categories" href="/categories/%E8%B7%AF%E5%BE%84%E8%A7%84%E5%88%92/%E5%85%A8%E5%B1%80%E8%B7%AF%E5%BE%84%E7%AE%97%E6%B3%95/">全局路径算法</a></span><div class="content"><p><a target="_blank" rel="noopener" href="https://youtu.be/bjMK5P5YhrU">视频</a><br>这个问题的本质是ROS的全局路径算法不考虑车体的轮廓，跟轮廓有关的避障交给了局部路径，DWA和TEB算法里都有<code>footprintCost</code>之类的函数，可以判断是否撞了障碍，但全局路径算法没有。 全局路径是把车当成了点，从所在栅格到目标栅格进行规划。这里开始规划出的路线就是这样，在走了一段时间被TEB认为不可行后，全局路径换成另一条，但是马上被认为不如之前的全局路径更优，又换回去了。如此循环，所以走不出去了。</p>
<p>但是要让全局路径考虑轮廓，会改动很大(即使不考虑动态障碍)，成本太高了。所以有必要考虑其他导航框架了。</p>
<p>暂时的解决方法只有设置中间点或者加虚拟墙</p>
</div><hr></div><nav id="pagination"><div class="pagination"><span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><span class="space">&hellip;</span><a class="page-number" href="/page/48/">48</a><a class="extend next" rel="next" href="/page/2/">Next &gt;&gt;</a></div></nav></div></div><footer class="footer-bg" style="background-image: url(https://i.loli.net/2021/07/13/RCLw5Bx8aFPN74b.jpg)"><div class="layout" id="footer"><div class="copyright">&copy;2018 - 2021 By Charon Cheung</div><div class="framework-info"><span>Driven - </span><a target="_blank" rel="noopener" href="http://hexo.io"><span>Hexo</span></a><span class="footer-separator">|</span><span>Theme - </span><a target="_blank" rel="noopener" href="https://github.com/Molunerfinn/hexo-theme-melody"><span>Melody</span></a></div><div class="busuanzi"><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><span id="busuanzi_container_site_uv"><i class="fa fa-user"></i><span id="busuanzi_value_site_uv"></span><span></span></span><span class="footer-separator">|</span><span id="busuanzi_container_site_pv"><i class="fa fa-eye"></i><span id="busuanzi_value_site_pv"></span><span></span></span></div></div></footer><i class="fa fa-arrow-up" id="go-up" aria-hidden="true"></i><script src="https://cdn.jsdelivr.net/npm/animejs@latest/anime.min.js"></script><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-animate@latest/velocity.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-ui-pack@latest/velocity.ui.min.js"></script><script src="/js/utils.js?version=1.6.1"></script><script src="/js/fancybox.js?version=1.6.1"></script><script src="/js/sidebar.js?version=1.6.1"></script><script src="/js/copy.js?version=1.6.1"></script><script src="/js/fireworks.js?version=1.6.1"></script><script src="/js/transition.js?version=1.6.1"></script><script src="/js/scroll.js?version=1.6.1"></script><script src="/js/head.js?version=1.6.1"></script><script type="text/x-mathjax-config">MathJax.Hub.Config({
  tex2jax: {
    inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
    processEscapes: true,
    skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
  },
  CommonHTML: {
    linebreaks: { automatic: true, width: "90% container" }
  },
  "HTML-CSS": { 
    linebreaks: { automatic: true, width: "90% container" }
  },
  "SVG": { 
    linebreaks: { automatic: true, width: "90% container" }
  }
});
</script><script type="text/x-mathjax-config">MathJax.Hub.Queue(function() {
  var all = MathJax.Hub.getAllJax(), i;
  for (i=0; i < all.length; i += 1) {
    all[i].SourceElement().parentNode.className += ' has-jax';
  }
});
</script><script src="https://cdn.bootcss.com/mathjax/2.7.2/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><script>if(/Android|webOS|iPhone|iPod|BlackBerry/i.test(navigator.userAgent)) {
  $('#nav').addClass('is-mobile')
  $('footer').addClass('is-mobile')
}</script></body></html>